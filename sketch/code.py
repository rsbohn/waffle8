from pdp8 import EMULATOR as emu

DULL_BOY_ORIGIN = 0o0200
DULL_BOY_ROM = [
    0o7300,
    0o7200,
    0o1245,
    0o4205,
    0o5201,
    0o0000,
    0o3241,
    0o1641,
    0o7440,
    0o5213,
    0o5605,
    0o4217,
    0o4227,
    0o2241,
    0o5207,
    0o0000,
    0o3242,
    0o6041,
    0o5221,
    0o1242,
    0o6046,
    0o7200,
    0o5617,
    0o0000,
    0o1246,
    0o3243,
    0o1247,
    0o3244,
    0o2244,
    0o5234,
    0o2243,
    0o5232,
    0o5627,
    0o0000,
    0o0000,
    0o0000,
    0o0000,
    0o0250,
    0o7740,
    0o7400,
    0o0101,
    0o0154,
    0o0154,
    0o0040,
    0o0167,
    0o0157,
    0o0162,
    0o0153,
    0o0040,
    0o0141,
    0o0156,
    0o0144,
    0o0040,
    0o0156,
    0o0157,
    0o0040,
    0o0160,
    0o0154,
    0o0141,
    0o0171,
    0o0040,
    0o0155,
    0o0141,
    0o0153,
    0o0145,
    0o0040,
    0o0112,
    0o0141,
    0o0143,
    0o0153,
    0o0040,
    0o0141,
    0o0040,
    0o0144,
    0o0165,
    0o0154,
    0o0154,
    0o0040,
    0o0142,
    0o0157,
    0o0171,
    0o0056,
    0o0015,
    0o0012,
    0o0000,
]

# Speed up the SLOWLY delay loops for the microcontroller demo.
DULL_BOY_ROM[38] = 0o7777  # DELAY_OUTER_INIT -> -1
DULL_BOY_ROM[39] = 0o7777  # DELAY_INNER_INIT -> -1

emu.reset()
emu.load(DULL_BOY_ORIGIN, DULL_BOY_ROM)
emu.pc = DULL_BOY_ORIGIN

while True:
    emu.step()
    if emu.halted:
        break
    if emu.output and emu.output[-1] == "\n":
        emu.output.clear()
